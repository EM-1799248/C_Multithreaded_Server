test:
  var:
    basic:
      program: null 
      deps: utils/node.c utils/linked_list.c utils/map.c utils/string_vector.c utils/list.c
  cmd:
    - gcc test/test_$(program).c $(deps) -Wall -pthread -o out/test_$(program).o
    - ./out/test_$(program).o


server:
  var:
    basic:
      port: 8080
      pattern: happy
      deps: utils/node.c utils/linked_list.c utils/map.c utils/string_vector.c utils/list.c
  cmd:
    - mkdir -p out
    - gcc -Wall $(deps) src/server.c -o out/server.o -pthread
    - ./out/server.o -l $(port) -p $(pattern)

program:
  var:
    basic:
      name: null
      port: 8080
      src: src 
      out: out
  cmd:
    - mkdir -p $(out)
    - gcc -Wall $(src)/$(name).c -o $(out)/$(name).o -pthread -DPORT=$(port)
    - ./$(out)/$(name).o

send_file:
  var:
    basic:
      name: null
      delay: null
      port: 8080
  cmd:
    - sleep $(delay) && nc -N 127.0.0.1 $(port) < resources/$(name)


clean:
  cmd:
    - rm -rf out/*
    - clear