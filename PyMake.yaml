test_map:
  var:
    basic:
      src: utils
      out: out 
      test_src: test 
  cmd:
    - mkdir -p $(out)
    - gcc -Wall $(test_src)/test_map.c $(src)/map.c -o $(out)/test_map.o -pthread
    - ./$(out)/test_map.o

test:
  var:
    basic:
      name: null
      src: utils
      out: out 
      test_src: test 
  cmd:
    - mkdir -p $(out)
    - gcc -Wall $(src)/map.c $(src)/$(name).c $(test_src)/test_$(name).c -o $(out)/test_$(name).o -pthread
    - ./$(out)/test_$(name).o

test_ll:
  cmd:
    - gcc test/test_linked_list.c utils/node.c utils/linked_list.c -o out/test_linked_list.out -Wall -pthread
    - ./out/test_linked_list.out

test_map:
  cmd:
    - gcc test/test_map.c utils/node.c utils/linked_list.c utils/map.c -o out/test_map.out -Wall -pthread
    - ./out/test_map.out

server:
  var:
    basic:
      port: 8080
      pattern: happy
      src: src 
      out: out
      utils: utils
  cmd:
    - mkdir -p $(out)
    - gcc -Wall $(utils)/string_vector.c $(utils)/list.c $(utils)/map.c $(src)/server.c -o $(out)/server.o -pthread
    - ./$(out)/server.o -l $(port) -p $(pattern)

program:
  var:
    basic:
      name: null
      port: 8080
      src: src 
      out: out
  cmd:
    - mkdir -p $(out)
    - gcc -Wall $(src)/$(name).c -o $(out)/$(name).o -pthread -DPORT=$(port)
    - ./$(out)/$(name).o

send_file:
  var:
    basic:
      name: null
      delay: null
      port: 8080
  cmd:
    - sleep $(delay) && nc -N 127.0.0.1 $(port) < resources/$(name)


clean:
  cmd:
    - rm -rf out/*
    - clear